2021-07-19 16:13:58.503924: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-07-19 16:14:05.348343: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-07-19 16:14:05.445031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:05:00.0 name: GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.582GHz coreCount: 28 deviceMemorySize: 10.91GiB deviceMemoryBandwidth: 451.17GiB/s
2021-07-19 16:14:05.447170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 1 with properties: 
pciBusID: 0000:09:00.0 name: GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.6705GHz coreCount: 28 deviceMemorySize: 10.92GiB deviceMemoryBandwidth: 451.17GiB/s
2021-07-19 16:14:05.447231: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-07-19 16:14:05.449144: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-07-19 16:14:05.451379: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-07-19 16:14:05.451803: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-07-19 16:14:05.453904: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-07-19 16:14:05.455054: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-07-19 16:14:05.459464: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-07-19 16:14:05.467151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0, 1
2021-07-19 16:14:11.998440: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-07-19 16:14:12.006740: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2398325000 Hz
2021-07-19 16:14:12.007928: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555cc3c9b700 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-19 16:14:12.007953: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-19 16:14:12.276720: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555cc3d07470 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-07-19 16:14:12.276767: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2021-07-19 16:14:12.276777: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): GeForce GTX 1080 Ti, Compute Capability 6.1
2021-07-19 16:14:12.280515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:05:00.0 name: GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.582GHz coreCount: 28 deviceMemorySize: 10.91GiB deviceMemoryBandwidth: 451.17GiB/s
2021-07-19 16:14:12.284308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 1 with properties: 
pciBusID: 0000:09:00.0 name: GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.6705GHz coreCount: 28 deviceMemorySize: 10.92GiB deviceMemoryBandwidth: 451.17GiB/s
2021-07-19 16:14:12.284408: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-07-19 16:14:12.284459: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-07-19 16:14:12.284515: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-07-19 16:14:12.284557: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-07-19 16:14:12.284597: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-07-19 16:14:12.284636: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-07-19 16:14:12.284677: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-07-19 16:14:12.300210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0, 1
2021-07-19 16:14:12.300326: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-07-19 16:14:14.226688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-07-19 16:14:14.226733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 1 
2021-07-19 16:14:14.226741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N Y 
2021-07-19 16:14:14.226747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 1:   Y N 
2021-07-19 16:14:14.231830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10262 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:05:00.0, compute capability: 6.1)
2021-07-19 16:14:14.233857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10264 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080 Ti, pci bus id: 0000:09:00.0, compute capability: 6.1)
2021-07-19 16:15:45.651436: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-07-19 16:15:46.433094: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
/ssd1/jiaqi/image_project/InstanceSeg-MedicalImages
Weights:  coco
Dataset:  datasets/CoNSeP
Subset:  train
Logs:  /ssd1/jiaqi/image_project/InstanceSeg-MedicalImages/logs

Configurations:
BACKBONE                       resnet50
BACKBONE_STRIDES               [4, 8, 16, 32, 64]
BATCH_SIZE                     4
BBOX_STD_DEV                   [0.1 0.1 0.2 0.2]
COMPUTE_BACKBONE_SHAPE         None
DETECTION_MAX_INSTANCES        400
DETECTION_MIN_CONFIDENCE       0.4
DETECTION_NMS_THRESHOLD        0.3
FPN_CLASSIF_FC_LAYERS_SIZE     1024
GPU_COUNT                      2
GRADIENT_CLIP_NORM             5.0
IMAGES_PER_GPU                 2
IMAGE_CHANNEL_COUNT            3
IMAGE_MAX_DIM                  256
IMAGE_META_SIZE                20
IMAGE_MIN_DIM                  256
IMAGE_MIN_SCALE                0
IMAGE_RESIZE_MODE              crop
IMAGE_SHAPE                    [256 256   3]
LEARNING_MOMENTUM              0.9
LEARNING_RATE                  0.001
LOSS_WEIGHTS                   {'rpn_class_loss': 1.0, 'rpn_bbox_loss': 1.0, 'mrcnn_class_loss': 1.0, 'mrcnn_bbox_loss': 1.0, 'mrcnn_mask_loss': 1.0}
MASK_POOL_SIZE                 14
MASK_SHAPE                     [28, 28]
MAX_GT_INSTANCES               200
MEAN_PIXEL                     [43.53 39.56 48.22]
MINI_MASK_SHAPE                (56, 56)
NAME                           consep
NUM_CLASSES                    8
POOL_SIZE                      7
POST_NMS_ROIS_INFERENCE        2000
POST_NMS_ROIS_TRAINING         1000
PRE_NMS_LIMIT                  6000
ROI_POSITIVE_RATIO             0.4
RPN_ANCHOR_RATIOS              [0.5, 1, 2]
RPN_ANCHOR_SCALES              (8, 16, 32, 64, 128)
RPN_ANCHOR_STRIDE              1
RPN_BBOX_STD_DEV               [0.1 0.1 0.2 0.2]
RPN_NMS_THRESHOLD              0.8
RPN_TRAIN_ANCHORS_PER_IMAGE    64
STEPS_PER_EPOCH                13
TOP_DOWN_PYRAMID_SIZE          256
TRAIN_BN                       False
TRAIN_ROIS_PER_IMAGE           128
USE_MINI_MASK                  True
USE_RPN_ROIS                   True
VALIDATION_STEPS               7
WEIGHT_DECAY                   0.0001


Loading weights  /ssd1/jiaqi/image_project/InstanceSeg-MedicalImages/mask_rcnn_coco.h5
['train_20.png', 'train_8.png', 'train_5.png', 'train_9.png', 'train_12.png', 'train_19.png', 'train_27.png', 'train_6.png', 'train_16.png', 'train_4.png', 'train_7.png', 'train_2.png', 'train_10.png', 'train_11.png', 'train_23.png', 'train_1.png', 'train_13.png', 'train_17.png', 'train_3.png', 'train_24.png', 'train_18.png', 'train_22.png', 'train_26.png', 'train_15.png', 'train_21.png', 'train_25.png', 'train_14.png']
['test_12.png', 'test_7.png', 'test_13.png', 'test_8.png', 'test_5.png', 'test_14.png', 'test_3.png', 'test_10.png', 'test_9.png', 'test_4.png', 'test_1.png', 'test_11.png', 'test_6.png', 'test_2.png']
Train network heads

Starting at epoch 0. LR=0.001

Checkpoint Path: /ssd1/jiaqi/image_project/InstanceSeg-MedicalImages/logs/consep20210719T1614/mask_rcnn_consep_{epoch:04d}.h5
Selecting layers to train
fpn_c5p5               (Conv2D)
fpn_c4p4               (Conv2D)
fpn_c3p3               (Conv2D)
fpn_c2p2               (Conv2D)
fpn_p5                 (Conv2D)
fpn_p2                 (Conv2D)
fpn_p3                 (Conv2D)
fpn_p4                 (Conv2D)
rpn_model              (Functional)
mrcnn_mask_conv1       (TimeDistributed)
mrcnn_mask_bn1         (TimeDistributed)
mrcnn_mask_conv2       (TimeDistributed)
mrcnn_mask_bn2         (TimeDistributed)
mrcnn_class_conv1      (TimeDistributed)
mrcnn_class_bn1        (TimeDistributed)
mrcnn_mask_conv3       (TimeDistributed)
mrcnn_mask_bn3         (TimeDistributed)
mrcnn_class_conv2      (TimeDistributed)
mrcnn_class_bn2        (TimeDistributed)
mrcnn_mask_conv4       (TimeDistributed)
mrcnn_mask_bn4         (TimeDistributed)
mrcnn_bbox_fc          (TimeDistributed)
mrcnn_mask_deconv      (TimeDistributed)
mrcnn_class_logits     (TimeDistributed)
mrcnn_mask             (TimeDistributed)
Epoch 1/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 8.66682021-07-19 16:16:59.672731: I tensorflow/core/profiler/lib/profiler_session.cc:164] Profiler session started.
2021-07-19 16:16:59.672836: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1391] Profiler found 2 GPUs
2021-07-19 16:16:59.673307: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory
2021-07-19 16:16:59.674474: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcupti.so
2021-07-19 16:17:00.701898: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1513] CUPTI activity buffer flushed
2021-07-19 16:17:00.771439: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:223]  GpuTracer has collected 5496 callback api events and 5496 activity events. 
2021-07-19 16:17:01.078526: I tensorflow/core/profiler/rpc/client/save_profile.cc:176] Creating directory: /ssd1/jiaqi/image_project/InstanceSeg-MedicalImages/logs/consep20210719T1614/plugins/profile/2021_07_19_16_17_00
2021-07-19 16:17:01.212283: I tensorflow/core/profiler/rpc/client/save_profile.cc:182] Dumped gzipped tool data for trace.json.gz to /ssd1/jiaqi/image_project/InstanceSeg-MedicalImages/logs/consep20210719T1614/plugins/profile/2021_07_19_16_17_00/panther.trace.json.gz
2021-07-19 16:17:01.435134: I tensorflow/core/profiler/rpc/client/save_profile.cc:176] Creating directory: /ssd1/jiaqi/image_project/InstanceSeg-MedicalImages/logs/consep20210719T1614/plugins/profile/2021_07_19_16_17_00
2021-07-19 16:17:01.457244: I tensorflow/core/profiler/rpc/client/save_profile.cc:182] Dumped gzipped tool data for memory_profile.json.gz to /ssd1/jiaqi/image_project/InstanceSeg-MedicalImages/logs/consep20210719T1614/plugins/profile/2021_07_19_16_17_00/panther.memory_profile.json.gz
2021-07-19 16:17:01.470592: I tensorflow/python/profiler/internal/profiler_wrapper.cc:111] Creating directory: /ssd1/jiaqi/image_project/InstanceSeg-MedicalImages/logs/consep20210719T1614/plugins/profile/2021_07_19_16_17_00Dumped tool data for xplane.pb to /ssd1/jiaqi/image_project/InstanceSeg-MedicalImages/logs/consep20210719T1614/plugins/profile/2021_07_19_16_17_00/panther.xplane.pb
Dumped tool data for overview_page.pb to /ssd1/jiaqi/image_project/InstanceSeg-MedicalImages/logs/consep20210719T1614/plugins/profile/2021_07_19_16_17_00/panther.overview_page.pb
Dumped tool data for input_pipeline.pb to /ssd1/jiaqi/image_project/InstanceSeg-MedicalImages/logs/consep20210719T1614/plugins/profile/2021_07_19_16_17_00/panther.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to /ssd1/jiaqi/image_project/InstanceSeg-MedicalImages/logs/consep20210719T1614/plugins/profile/2021_07_19_16_17_00/panther.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to /ssd1/jiaqi/image_project/InstanceSeg-MedicalImages/logs/consep20210719T1614/plugins/profile/2021_07_19_16_17_00/panther.kernel_stats.pb

 2/13 [===>..........................] - ETA: 6:26 - batch: 0.5000 - size: 4.0000 - loss: 8.1779  /home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 767) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 699) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 262) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 293) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/indexed_slices.py:433: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 767) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 2283) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 100) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 135) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
WARNING:tensorflow:Callbacks method `on_train_batch_begin` is slow compared to the batch time (batch time: 0.3858s vs `on_train_batch_begin` time: 0.6374s). Check your callbacks.
WARNING:tensorflow:Callbacks method `on_train_batch_end` is slow compared to the batch time (batch time: 0.3858s vs `on_train_batch_end` time: 0.7970s). Check your callbacks.
 3/13 [=====>........................] - ETA: 8:32 - batch: 1.0000 - size: 4.0000 - loss: 7.6720 4/13 [========>.....................] - ETA: 7:19 - batch: 1.5000 - size: 4.0000 - loss: 6.8733 5/13 [==========>...................] - ETA: 7:36 - batch: 2.0000 - size: 4.0000 - loss: 6.2799/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 741) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 805) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 997) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 80) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 677) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 891) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 145) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 63) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 539) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 502) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 749) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 850) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 1242) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 161) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
 6/13 [============>.................] - ETA: 6:31 - batch: 2.5000 - size: 4.0000 - loss: 5.8428 7/13 [===============>..............] - ETA: 5:24 - batch: 3.0000 - size: 4.0000 - loss: 5.5461 8/13 [=================>............] - ETA: 4:12 - batch: 3.5000 - size: 4.0000 - loss: 5.3260/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 647) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 839) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 261) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 40) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 749) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 100) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 839) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 145) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 741) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 63) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 161) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 293) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 262) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 850) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
 9/13 [===================>..........] - ETA: 3:24 - batch: 4.0000 - size: 4.0000 - loss: 5.159710/13 [======================>.......] - ETA: 2:35 - batch: 4.5000 - size: 4.0000 - loss: 5.010311/13 [========================>.....] - ETA: 1:43 - batch: 5.0000 - size: 4.0000 - loss: 4.858212/13 [==========================>...] - ETA: 54s - batch: 5.5000 - size: 4.0000 - loss: 4.7847 /home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 677) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 539) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 699) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 891) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 135) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 647) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 502) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 40) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 767) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 80) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 997) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 767) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 1242) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 2283) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
13/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 4.6945 /home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 261) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 805) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 161) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 293) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 100) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
/home/jiaqi/anaconda3/lib/python3.7/site-packages/imgaug/augmenters/base.py:59: SuspiciousSingleImageShapeWarning: You provided a numpy array of shape (256, 256, 767) as a single-image augmentation input, which was interpreted as (H, W, C). The last dimension however has a size of >=32, which indicates that you provided a multi-image array with shape (N, H, W) instead. If that is the case, you should use e.g. augmenter(imageS=<your input>) or augment_imageS(<your input>). Otherwise your multi-image input will be interpreted as a single image during augmentation.
  category=SuspiciousSingleImageShapeWarning)
WARNING:tensorflow:From /ssd1/jiaqi/image_project/InstanceSeg-MedicalImages/mrcnn/parallel_model.py:47: Model.state_updates (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
13/13 [==============================] - 1235s 95s/step - batch: 6.0000 - size: 4.0000 - loss: 4.6945 - val_loss: 3.5188
Epoch 2/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 3.1098 2/13 [===>..........................] - ETA: 1s - batch: 0.5000 - size: 4.0000 - loss: 3.3115     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 3.4151 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 3.4592 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 3.5519 6/13 [============>.................] - ETA: 2s - batch: 2.5000 - size: 4.0000 - loss: 3.5157 7/13 [===============>..............] - ETA: 1s - batch: 3.0000 - size: 4.0000 - loss: 3.5092 8/13 [=================>............] - ETA: 3s - batch: 3.5000 - size: 4.0000 - loss: 3.4549 9/13 [===================>..........] - ETA: 18s - batch: 4.0000 - size: 4.0000 - loss: 3.384210/13 [======================>.......] - ETA: 41s - batch: 4.5000 - size: 4.0000 - loss: 3.410111/13 [========================>.....] - ETA: 32s - batch: 5.0000 - size: 4.0000 - loss: 3.418012/13 [==========================>...] - ETA: 20s - batch: 5.5000 - size: 4.0000 - loss: 3.393513/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 3.3862 13/13 [==============================] - 817s 63s/step - batch: 6.0000 - size: 4.0000 - loss: 3.3862 - val_loss: 3.5166
Epoch 3/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 3.2384 2/13 [===>..........................] - ETA: 1s - batch: 0.5000 - size: 4.0000 - loss: 3.1926     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 3.2260 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 3.2324 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 3.1907 6/13 [============>.................] - ETA: 2s - batch: 2.5000 - size: 4.0000 - loss: 3.1657 7/13 [===============>..............] - ETA: 1s - batch: 3.0000 - size: 4.0000 - loss: 3.1668 8/13 [=================>............] - ETA: 1s - batch: 3.5000 - size: 4.0000 - loss: 3.1535 9/13 [===================>..........] - ETA: 16s - batch: 4.0000 - size: 4.0000 - loss: 3.155410/13 [======================>.......] - ETA: 25s - batch: 4.5000 - size: 4.0000 - loss: 3.158911/13 [========================>.....] - ETA: 38s - batch: 5.0000 - size: 4.0000 - loss: 3.201412/13 [==========================>...] - ETA: 20s - batch: 5.5000 - size: 4.0000 - loss: 3.200613/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 3.1940 13/13 [==============================] - 755s 58s/step - batch: 6.0000 - size: 4.0000 - loss: 3.1940 - val_loss: 3.2868
Epoch 4/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 3.3233 2/13 [===>..........................] - ETA: 1s - batch: 0.5000 - size: 4.0000 - loss: 3.1364     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 3.1536 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 3.1702 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 3.2170 6/13 [============>.................] - ETA: 2s - batch: 2.5000 - size: 4.0000 - loss: 3.2333 7/13 [===============>..............] - ETA: 21s - batch: 3.0000 - size: 4.0000 - loss: 3.2776 8/13 [=================>............] - ETA: 40s - batch: 3.5000 - size: 4.0000 - loss: 3.2522 9/13 [===================>..........] - ETA: 1:00 - batch: 4.0000 - size: 4.0000 - loss: 3.269610/13 [======================>.......] - ETA: 1:00 - batch: 4.5000 - size: 4.0000 - loss: 3.254211/13 [========================>.....] - ETA: 44s - batch: 5.0000 - size: 4.0000 - loss: 3.2435 12/13 [==========================>...] - ETA: 26s - batch: 5.5000 - size: 4.0000 - loss: 3.218413/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 3.2287 13/13 [==============================] - 850s 65s/step - batch: 6.0000 - size: 4.0000 - loss: 3.2287 - val_loss: 3.0827
Epoch 5/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 2.9213 2/13 [===>..........................] - ETA: 1s - batch: 0.5000 - size: 4.0000 - loss: 3.0163     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 3.0294 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 2.9877 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 2.9808 6/13 [============>.................] - ETA: 1s - batch: 2.5000 - size: 4.0000 - loss: 2.9465 7/13 [===============>..............] - ETA: 1s - batch: 3.0000 - size: 4.0000 - loss: 3.0020 8/13 [=================>............] - ETA: 5s - batch: 3.5000 - size: 4.0000 - loss: 3.0217 9/13 [===================>..........] - ETA: 29s - batch: 4.0000 - size: 4.0000 - loss: 3.022810/13 [======================>.......] - ETA: 47s - batch: 4.5000 - size: 4.0000 - loss: 3.041811/13 [========================>.....] - ETA: 33s - batch: 5.0000 - size: 4.0000 - loss: 3.038612/13 [==========================>...] - ETA: 24s - batch: 5.5000 - size: 4.0000 - loss: 3.029913/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 3.0330 13/13 [==============================] - 803s 62s/step - batch: 6.0000 - size: 4.0000 - loss: 3.0330 - val_loss: 3.1883
Epoch 6/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 3.1392 2/13 [===>..........................] - ETA: 2s - batch: 0.5000 - size: 4.0000 - loss: 2.9987     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 2.9751 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 3.0153 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 2.9861 6/13 [============>.................] - ETA: 2s - batch: 2.5000 - size: 4.0000 - loss: 2.9812 7/13 [===============>..............] - ETA: 1s - batch: 3.0000 - size: 4.0000 - loss: 2.9634 8/13 [=================>............] - ETA: 12s - batch: 3.5000 - size: 4.0000 - loss: 2.9592 9/13 [===================>..........] - ETA: 45s - batch: 4.0000 - size: 4.0000 - loss: 2.977410/13 [======================>.......] - ETA: 40s - batch: 4.5000 - size: 4.0000 - loss: 2.927411/13 [========================>.....] - ETA: 35s - batch: 5.0000 - size: 4.0000 - loss: 2.942412/13 [==========================>...] - ETA: 23s - batch: 5.5000 - size: 4.0000 - loss: 2.928413/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 2.9212 13/13 [==============================] - 856s 66s/step - batch: 6.0000 - size: 4.0000 - loss: 2.9212 - val_loss: 3.0224
Epoch 7/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 2.6154 2/13 [===>..........................] - ETA: 1s - batch: 0.5000 - size: 4.0000 - loss: 2.7262     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 2.8609 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 2.9070 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 2.8885 6/13 [============>.................] - ETA: 2s - batch: 2.5000 - size: 4.0000 - loss: 2.8718 7/13 [===============>..............] - ETA: 1s - batch: 3.0000 - size: 4.0000 - loss: 2.9027 8/13 [=================>............] - ETA: 1s - batch: 3.5000 - size: 4.0000 - loss: 2.9411 9/13 [===================>..........] - ETA: 9s - batch: 4.0000 - size: 4.0000 - loss: 2.910310/13 [======================>.......] - ETA: 32s - batch: 4.5000 - size: 4.0000 - loss: 2.930411/13 [========================>.....] - ETA: 28s - batch: 5.0000 - size: 4.0000 - loss: 2.900712/13 [==========================>...] - ETA: 20s - batch: 5.5000 - size: 4.0000 - loss: 2.892213/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 2.8897 13/13 [==============================] - 780s 60s/step - batch: 6.0000 - size: 4.0000 - loss: 2.8897 - val_loss: 3.0766
Epoch 8/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 3.2247 2/13 [===>..........................] - ETA: 2s - batch: 0.5000 - size: 4.0000 - loss: 3.0678     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 3.0081 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 3.0081 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 2.8628 6/13 [============>.................] - ETA: 2s - batch: 2.5000 - size: 4.0000 - loss: 2.9150 7/13 [===============>..............] - ETA: 1s - batch: 3.0000 - size: 4.0000 - loss: 2.9269 8/13 [=================>............] - ETA: 4s - batch: 3.5000 - size: 4.0000 - loss: 2.9312 9/13 [===================>..........] - ETA: 32s - batch: 4.0000 - size: 4.0000 - loss: 2.944010/13 [======================>.......] - ETA: 35s - batch: 4.5000 - size: 4.0000 - loss: 2.937711/13 [========================>.....] - ETA: 41s - batch: 5.0000 - size: 4.0000 - loss: 2.976812/13 [==========================>...] - ETA: 22s - batch: 5.5000 - size: 4.0000 - loss: 2.979313/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 3.0105 13/13 [==============================] - 807s 62s/step - batch: 6.0000 - size: 4.0000 - loss: 3.0105 - val_loss: 3.0451
Epoch 9/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 2.7746 2/13 [===>..........................] - ETA: 1s - batch: 0.5000 - size: 4.0000 - loss: 2.9450     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 2.7799 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 2.8520 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 2.8124 6/13 [============>.................] - ETA: 2s - batch: 2.5000 - size: 4.0000 - loss: 2.8340 7/13 [===============>..............] - ETA: 1s - batch: 3.0000 - size: 4.0000 - loss: 2.8527 8/13 [=================>............] - ETA: 10s - batch: 3.5000 - size: 4.0000 - loss: 2.8390 9/13 [===================>..........] - ETA: 11s - batch: 4.0000 - size: 4.0000 - loss: 2.800010/13 [======================>.......] - ETA: 37s - batch: 4.5000 - size: 4.0000 - loss: 2.832411/13 [========================>.....] - ETA: 32s - batch: 5.0000 - size: 4.0000 - loss: 2.870212/13 [==========================>...] - ETA: 18s - batch: 5.5000 - size: 4.0000 - loss: 2.871113/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 2.8816 13/13 [==============================] - 819s 63s/step - batch: 6.0000 - size: 4.0000 - loss: 2.8816 - val_loss: 3.0347
Epoch 10/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 3.0738 2/13 [===>..........................] - ETA: 1s - batch: 0.5000 - size: 4.0000 - loss: 2.8538     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 2.8425 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 2.8054 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 2.8596 6/13 [============>.................] - ETA: 2s - batch: 2.5000 - size: 4.0000 - loss: 2.8736 7/13 [===============>..............] - ETA: 1s - batch: 3.0000 - size: 4.0000 - loss: 2.8800 8/13 [=================>............] - ETA: 1s - batch: 3.5000 - size: 4.0000 - loss: 2.8747 9/13 [===================>..........] - ETA: 26s - batch: 4.0000 - size: 4.0000 - loss: 2.891710/13 [======================>.......] - ETA: 31s - batch: 4.5000 - size: 4.0000 - loss: 2.883911/13 [========================>.....] - ETA: 39s - batch: 5.0000 - size: 4.0000 - loss: 2.852312/13 [==========================>...] - ETA: 20s - batch: 5.5000 - size: 4.0000 - loss: 2.838713/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 2.8131 13/13 [==============================] - 790s 61s/step - batch: 6.0000 - size: 4.0000 - loss: 2.8131 - val_loss: 3.0823
Epoch 11/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 2.5863 2/13 [===>..........................] - ETA: 1s - batch: 0.5000 - size: 4.0000 - loss: 2.6816     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 2.7456 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 2.7687 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 2.8828 6/13 [============>.................] - ETA: 2s - batch: 2.5000 - size: 4.0000 - loss: 2.8756 7/13 [===============>..............] - ETA: 1s - batch: 3.0000 - size: 4.0000 - loss: 2.8515 8/13 [=================>............] - ETA: 1s - batch: 3.5000 - size: 4.0000 - loss: 2.8446 9/13 [===================>..........] - ETA: 18s - batch: 4.0000 - size: 4.0000 - loss: 2.800710/13 [======================>.......] - ETA: 31s - batch: 4.5000 - size: 4.0000 - loss: 2.793311/13 [========================>.....] - ETA: 26s - batch: 5.0000 - size: 4.0000 - loss: 2.812012/13 [==========================>...] - ETA: 18s - batch: 5.5000 - size: 4.0000 - loss: 2.821413/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 2.8136 13/13 [==============================] - 728s 56s/step - batch: 6.0000 - size: 4.0000 - loss: 2.8136 - val_loss: 2.9383
Epoch 12/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 2.7168 2/13 [===>..........................] - ETA: 1s - batch: 0.5000 - size: 4.0000 - loss: 2.4253     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 2.6306 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 2.6901 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 2.7382 6/13 [============>.................] - ETA: 2s - batch: 2.5000 - size: 4.0000 - loss: 2.6886 7/13 [===============>..............] - ETA: 1s - batch: 3.0000 - size: 4.0000 - loss: 2.7123 8/13 [=================>............] - ETA: 16s - batch: 3.5000 - size: 4.0000 - loss: 2.7059 9/13 [===================>..........] - ETA: 40s - batch: 4.0000 - size: 4.0000 - loss: 2.705210/13 [======================>.......] - ETA: 58s - batch: 4.5000 - size: 4.0000 - loss: 2.755011/13 [========================>.....] - ETA: 46s - batch: 5.0000 - size: 4.0000 - loss: 2.772912/13 [==========================>...] - ETA: 23s - batch: 5.5000 - size: 4.0000 - loss: 2.763413/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 2.7942 13/13 [==============================] - 832s 64s/step - batch: 6.0000 - size: 4.0000 - loss: 2.7942 - val_loss: 2.9770
Epoch 13/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 2.9843 2/13 [===>..........................] - ETA: 2s - batch: 0.5000 - size: 4.0000 - loss: 2.7103     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 2.7304 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 2.7440 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 2.7446 6/13 [============>.................] - ETA: 2s - batch: 2.5000 - size: 4.0000 - loss: 2.6753 7/13 [===============>..............] - ETA: 1s - batch: 3.0000 - size: 4.0000 - loss: 2.7000 8/13 [=================>............] - ETA: 10s - batch: 3.5000 - size: 4.0000 - loss: 2.7494 9/13 [===================>..........] - ETA: 33s - batch: 4.0000 - size: 4.0000 - loss: 2.735710/13 [======================>.......] - ETA: 53s - batch: 4.5000 - size: 4.0000 - loss: 2.735211/13 [========================>.....] - ETA: 36s - batch: 5.0000 - size: 4.0000 - loss: 2.707312/13 [==========================>...] - ETA: 21s - batch: 5.5000 - size: 4.0000 - loss: 2.703313/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 2.7144 13/13 [==============================] - 779s 60s/step - batch: 6.0000 - size: 4.0000 - loss: 2.7144 - val_loss: 2.8937
Epoch 14/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 2.5051 2/13 [===>..........................] - ETA: 1s - batch: 0.5000 - size: 4.0000 - loss: 2.6254     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 2.6068 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 2.7664 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 2.7913 6/13 [============>.................] - ETA: 2s - batch: 2.5000 - size: 4.0000 - loss: 2.8065 7/13 [===============>..............] - ETA: 1s - batch: 3.0000 - size: 4.0000 - loss: 2.7778 8/13 [=================>............] - ETA: 3s - batch: 3.5000 - size: 4.0000 - loss: 2.7470 9/13 [===================>..........] - ETA: 30s - batch: 4.0000 - size: 4.0000 - loss: 2.756810/13 [======================>.......] - ETA: 34s - batch: 4.5000 - size: 4.0000 - loss: 2.736411/13 [========================>.....] - ETA: 36s - batch: 5.0000 - size: 4.0000 - loss: 2.740112/13 [==========================>...] - ETA: 21s - batch: 5.5000 - size: 4.0000 - loss: 2.747713/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 2.7096 13/13 [==============================] - 800s 62s/step - batch: 6.0000 - size: 4.0000 - loss: 2.7096 - val_loss: 2.8679
Epoch 15/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 2.7587 2/13 [===>..........................] - ETA: 2s - batch: 0.5000 - size: 4.0000 - loss: 2.7212     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 2.8235 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 2.7591 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 2.8026 6/13 [============>.................] - ETA: 2s - batch: 2.5000 - size: 4.0000 - loss: 2.7708 7/13 [===============>..............] - ETA: 1s - batch: 3.0000 - size: 4.0000 - loss: 2.7727 8/13 [=================>............] - ETA: 19s - batch: 3.5000 - size: 4.0000 - loss: 2.7674 9/13 [===================>..........] - ETA: 39s - batch: 4.0000 - size: 4.0000 - loss: 2.746810/13 [======================>.......] - ETA: 1:04 - batch: 4.5000 - size: 4.0000 - loss: 2.741611/13 [========================>.....] - ETA: 45s - batch: 5.0000 - size: 4.0000 - loss: 2.7251 12/13 [==========================>...] - ETA: 24s - batch: 5.5000 - size: 4.0000 - loss: 2.719513/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 2.6979 13/13 [==============================] - 811s 62s/step - batch: 6.0000 - size: 4.0000 - loss: 2.6979 - val_loss: 2.6831
Epoch 16/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 2.8683 2/13 [===>..........................] - ETA: 1s - batch: 0.5000 - size: 4.0000 - loss: 2.8857     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 2.7262 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 2.8049 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 2.7766 6/13 [============>.................] - ETA: 2s - batch: 2.5000 - size: 4.0000 - loss: 2.8209 7/13 [===============>..............] - ETA: 1s - batch: 3.0000 - size: 4.0000 - loss: 2.8200 8/13 [=================>............] - ETA: 16s - batch: 3.5000 - size: 4.0000 - loss: 2.7857 9/13 [===================>..........] - ETA: 34s - batch: 4.0000 - size: 4.0000 - loss: 2.785010/13 [======================>.......] - ETA: 32s - batch: 4.5000 - size: 4.0000 - loss: 2.761311/13 [========================>.....] - ETA: 27s - batch: 5.0000 - size: 4.0000 - loss: 2.737612/13 [==========================>...] - ETA: 22s - batch: 5.5000 - size: 4.0000 - loss: 2.745513/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 2.7324 13/13 [==============================] - 768s 59s/step - batch: 6.0000 - size: 4.0000 - loss: 2.7324 - val_loss: 2.9659
Epoch 17/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 2.8819 2/13 [===>..........................] - ETA: 1s - batch: 0.5000 - size: 4.0000 - loss: 3.0306     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 2.9533 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 3.0057 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 2.9860 6/13 [============>.................] - ETA: 1s - batch: 2.5000 - size: 4.0000 - loss: 2.9257 7/13 [===============>..............] - ETA: 20s - batch: 3.0000 - size: 4.0000 - loss: 2.9083 8/13 [=================>............] - ETA: 40s - batch: 3.5000 - size: 4.0000 - loss: 2.8999 9/13 [===================>..........] - ETA: 45s - batch: 4.0000 - size: 4.0000 - loss: 2.905810/13 [======================>.......] - ETA: 1:08 - batch: 4.5000 - size: 4.0000 - loss: 2.887411/13 [========================>.....] - ETA: 50s - batch: 5.0000 - size: 4.0000 - loss: 2.8497 12/13 [==========================>...] - ETA: 26s - batch: 5.5000 - size: 4.0000 - loss: 2.835913/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 2.8311 13/13 [==============================] - 851s 65s/step - batch: 6.0000 - size: 4.0000 - loss: 2.8311 - val_loss: 2.7391
Epoch 18/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 2.5823 2/13 [===>..........................] - ETA: 1s - batch: 0.5000 - size: 4.0000 - loss: 2.5692     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 2.5969 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 2.6326 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 2.6455 6/13 [============>.................] - ETA: 1s - batch: 2.5000 - size: 4.0000 - loss: 2.5838 7/13 [===============>..............] - ETA: 1s - batch: 3.0000 - size: 4.0000 - loss: 2.6015 8/13 [=================>............] - ETA: 28s - batch: 3.5000 - size: 4.0000 - loss: 2.6238 9/13 [===================>..........] - ETA: 39s - batch: 4.0000 - size: 4.0000 - loss: 2.613510/13 [======================>.......] - ETA: 40s - batch: 4.5000 - size: 4.0000 - loss: 2.630011/13 [========================>.....] - ETA: 42s - batch: 5.0000 - size: 4.0000 - loss: 2.641212/13 [==========================>...] - ETA: 23s - batch: 5.5000 - size: 4.0000 - loss: 2.641213/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 2.6105 13/13 [==============================] - 828s 64s/step - batch: 6.0000 - size: 4.0000 - loss: 2.6105 - val_loss: 2.8072
Epoch 19/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 2.5746 2/13 [===>..........................] - ETA: 1s - batch: 0.5000 - size: 4.0000 - loss: 2.6354     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 2.4953 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 2.4345 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 2.4777 6/13 [============>.................] - ETA: 1s - batch: 2.5000 - size: 4.0000 - loss: 2.5317 7/13 [===============>..............] - ETA: 1s - batch: 3.0000 - size: 4.0000 - loss: 2.5747 8/13 [=================>............] - ETA: 4s - batch: 3.5000 - size: 4.0000 - loss: 2.5600 9/13 [===================>..........] - ETA: 1:03 - batch: 4.0000 - size: 4.0000 - loss: 2.575110/13 [======================>.......] - ETA: 53s - batch: 4.5000 - size: 4.0000 - loss: 2.5690 11/13 [========================>.....] - ETA: 44s - batch: 5.0000 - size: 4.0000 - loss: 2.597312/13 [==========================>...] - ETA: 24s - batch: 5.5000 - size: 4.0000 - loss: 2.594413/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 2.5734 13/13 [==============================] - 783s 60s/step - batch: 6.0000 - size: 4.0000 - loss: 2.5734 - val_loss: 2.6860
Epoch 20/20
 1/13 [=>............................] - ETA: 0s - batch: 0.0000e+00 - size: 4.0000 - loss: 2.5459 2/13 [===>..........................] - ETA: 1s - batch: 0.5000 - size: 4.0000 - loss: 2.5012     3/13 [=====>........................] - ETA: 2s - batch: 1.0000 - size: 4.0000 - loss: 2.6293 4/13 [========>.....................] - ETA: 2s - batch: 1.5000 - size: 4.0000 - loss: 2.6911 5/13 [==========>...................] - ETA: 2s - batch: 2.0000 - size: 4.0000 - loss: 2.6074 6/13 [============>.................] - ETA: 2s - batch: 2.5000 - size: 4.0000 - loss: 2.5148 7/13 [===============>..............] - ETA: 47s - batch: 3.0000 - size: 4.0000 - loss: 2.4979 8/13 [=================>............] - ETA: 1:25 - batch: 3.5000 - size: 4.0000 - loss: 2.5179 9/13 [===================>..........] - ETA: 1:25 - batch: 4.0000 - size: 4.0000 - loss: 2.534910/13 [======================>.......] - ETA: 1:19 - batch: 4.5000 - size: 4.0000 - loss: 2.538011/13 [========================>.....] - ETA: 56s - batch: 5.0000 - size: 4.0000 - loss: 2.5498 12/13 [==========================>...] - ETA: 29s - batch: 5.5000 - size: 4.0000 - loss: 2.531513/13 [==============================] - ETA: 0s - batch: 6.0000 - size: 4.0000 - loss: 2.5059 13/13 [==============================] - 853s 66s/step - batch: 6.0000 - size: 4.0000 - loss: 2.5059 - val_loss: 2.7706
Train all layers

Starting at epoch 20. LR=0.001

Checkpoint Path: /ssd1/jiaqi/image_project/InstanceSeg-MedicalImages/logs/consep20210719T1614/mask_rcnn_consep_{epoch:04d}.h5
Selecting layers to train
conv1                  (Conv2D)
bn_conv1               (BatchNorm)
res2a_branch2a         (Conv2D)
bn2a_branch2a          (BatchNorm)
res2a_branch2b         (Conv2D)
bn2a_branch2b          (BatchNorm)
res2a_branch2c         (Conv2D)
res2a_branch1          (Conv2D)
bn2a_branch2c          (BatchNorm)
bn2a_branch1           (BatchNorm)
res2b_branch2a         (Conv2D)
bn2b_branch2a          (BatchNorm)
res2b_branch2b         (Conv2D)
bn2b_branch2b          (BatchNorm)
res2b_branch2c         (Conv2D)
bn2b_branch2c          (BatchNorm)
res2c_branch2a         (Conv2D)
bn2c_branch2a          (BatchNorm)
res2c_branch2b         (Conv2D)
bn2c_branch2b          (BatchNorm)
res2c_branch2c         (Conv2D)
bn2c_branch2c          (BatchNorm)
res3a_branch2a         (Conv2D)
bn3a_branch2a          (BatchNorm)
res3a_branch2b         (Conv2D)
bn3a_branch2b          (BatchNorm)
res3a_branch2c         (Conv2D)
res3a_branch1          (Conv2D)
bn3a_branch2c          (BatchNorm)
bn3a_branch1           (BatchNorm)
res3b_branch2a         (Conv2D)
bn3b_branch2a          (BatchNorm)
res3b_branch2b         (Conv2D)
bn3b_branch2b          (BatchNorm)
res3b_branch2c         (Conv2D)
bn3b_branch2c          (BatchNorm)
res3c_branch2a         (Conv2D)
bn3c_branch2a          (BatchNorm)
res3c_branch2b         (Conv2D)
bn3c_branch2b          (BatchNorm)
res3c_branch2c         (Conv2D)
bn3c_branch2c          (BatchNorm)
res3d_branch2a         (Conv2D)
bn3d_branch2a          (BatchNorm)
res3d_branch2b         (Conv2D)
bn3d_branch2b          (BatchNorm)
res3d_branch2c         (Conv2D)
bn3d_branch2c          (BatchNorm)
res4a_branch2a         (Conv2D)
bn4a_branch2a          (BatchNorm)
res4a_branch2b         (Conv2D)
bn4a_branch2b          (BatchNorm)
res4a_branch2c         (Conv2D)
res4a_branch1          (Conv2D)
bn4a_branch2c          (BatchNorm)
bn4a_branch1           (BatchNorm)
res4b_branch2a         (Conv2D)
bn4b_branch2a          (BatchNorm)
res4b_branch2b         (Conv2D)
bn4b_branch2b          (BatchNorm)
res4b_branch2c         (Conv2D)
bn4b_branch2c          (BatchNorm)
res4c_branch2a         (Conv2D)
bn4c_branch2a          (BatchNorm)
res4c_branch2b         (Conv2D)
bn4c_branch2b          (BatchNorm)
res4c_branch2c         (Conv2D)
bn4c_branch2c          (BatchNorm)
res4d_branch2a         (Conv2D)
bn4d_branch2a          (BatchNorm)
res4d_branch2b         (Conv2D)
bn4d_branch2b          (BatchNorm)
res4d_branch2c         (Conv2D)
bn4d_branch2c          (BatchNorm)
res4e_branch2a         (Conv2D)
bn4e_branch2a          (BatchNorm)
res4e_branch2b         (Conv2D)
bn4e_branch2b          (BatchNorm)
res4e_branch2c         (Conv2D)
bn4e_branch2c          (BatchNorm)
res4f_branch2a         (Conv2D)
bn4f_branch2a          (BatchNorm)
res4f_branch2b         (Conv2D)
bn4f_branch2b          (BatchNorm)
res4f_branch2c         (Conv2D)
bn4f_branch2c          (BatchNorm)
res5a_branch2a         (Conv2D)
bn5a_branch2a          (BatchNorm)
res5a_branch2b         (Conv2D)
bn5a_branch2b          (BatchNorm)
res5a_branch2c         (Conv2D)
res5a_branch1          (Conv2D)
bn5a_branch2c          (BatchNorm)
bn5a_branch1           (BatchNorm)
res5b_branch2a         (Conv2D)
bn5b_branch2a          (BatchNorm)
res5b_branch2b         (Conv2D)
bn5b_branch2b          (BatchNorm)
res5b_branch2c         (Conv2D)
bn5b_branch2c          (BatchNorm)
res5c_branch2a         (Conv2D)
bn5c_branch2a          (BatchNorm)
res5c_branch2b         (Conv2D)
bn5c_branch2b          (BatchNorm)
res5c_branch2c         (Conv2D)
bn5c_branch2c          (BatchNorm)
fpn_c5p5               (Conv2D)
fpn_c4p4               (Conv2D)
fpn_c3p3               (Conv2D)
fpn_c2p2               (Conv2D)
fpn_p5                 (Conv2D)
fpn_p2                 (Conv2D)
fpn_p3                 (Conv2D)
fpn_p4                 (Conv2D)
rpn_model              (Functional)
anchors                (AnchorsLayer)
mrcnn_mask_conv1       (TimeDistributed)
mrcnn_mask_bn1         (TimeDistributed)
mrcnn_mask_conv2       (TimeDistributed)
mrcnn_mask_bn2         (TimeDistributed)
mrcnn_class_conv1      (TimeDistributed)
mrcnn_class_bn1        (TimeDistributed)
mrcnn_mask_conv3       (TimeDistributed)
mrcnn_mask_bn3         (TimeDistributed)
mrcnn_class_conv2      (TimeDistributed)
mrcnn_class_bn2        (TimeDistributed)
mrcnn_mask_conv4       (TimeDistributed)
mrcnn_mask_bn4         (TimeDistributed)
mrcnn_bbox_fc          (TimeDistributed)
mrcnn_mask_deconv      (TimeDistributed)
mrcnn_class_logits     (TimeDistributed)
mrcnn_mask             (TimeDistributed)
Traceback (most recent call last):
  File "models/consep/consep.py", line 445, in <module>
    train(model, args.dataset, args.subset)
  File "models/consep/consep.py", line 303, in train
    layers='all')
  File "/ssd1/jiaqi/image_project/InstanceSeg-MedicalImages/mrcnn/model.py", line 2372, in train
    self.compile(learning_rate, self.config.LEARNING_MOMENTUM)
  File "/ssd1/jiaqi/image_project/InstanceSeg-MedicalImages/mrcnn/model.py", line 2193, in compile
    self.keras_model.add_loss(loss)
  File "/home/jiaqi/anaconda3/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer_v1.py", line 1080, in add_loss
    self._graph_network_add_loss(symbolic_loss)
  File "/home/jiaqi/anaconda3/lib/python3.7/site-packages/tensorflow/python/keras/engine/functional.py", line 805, in _graph_network_add_loss
    self._insert_layers(new_layers, new_nodes)
  File "/home/jiaqi/anaconda3/lib/python3.7/site-packages/tensorflow/python/keras/engine/functional.py", line 748, in _insert_layers
    layer_set = set(self._layers)
  File "/home/jiaqi/anaconda3/lib/python3.7/site-packages/tensorflow/python/training/tracking/data_structures.py", line 609, in __hash__
    raise TypeError("unhashable type: 'ListWrapper'")
TypeError: unhashable type: 'ListWrapper'
